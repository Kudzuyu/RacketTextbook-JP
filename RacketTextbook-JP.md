# Racket日本語テキスト

<!-- TOC depth:6 withLinks:1 updateOnSave:1 orderedList:0 -->

	- [Racket日本語テキスト](#racket)
		- [0.序文と下準備](#0)
			- [この文書について](#)
			- [はじめに-RacketとLisp](#-racketlisp)
				- [Racketの特徴](#racket)
			- [Racketプログラミングのための準備](#racket)
				- [インストール](#)
				- [起動および日本語化](#)
				- [まとめ](#)
		- [1.プログラミングRacket Racket基礎編](#1racket-racket)
			- [Racket基礎その1 Hello World!とリストに関する各種名称](#racket1-hello-world)
				- [まずはお決まり、Hello World!](#hello-world)
				- [Racketの構造](#racket)
				- [まとめ](#)
			- [Racket基礎その2 リストの操作とアトムについて](#racket2-)
				- [対話環境の使い方](#)
				- [リストの各要素は、アトム](#)
				- [リスト操作のおきまり、carとcdr](#carcdr)
				- [carとcdrの複合技](#carcdr)
				- [まとめ](#)
				- [練習問題の解答](#)
			- [Racket基礎その3 リストを作る](#racket3-)
				- [carとcdrの逆関数、cons](#carcdrcons)
			- [Racket基礎その4 算術計算と条件演算子](#racket4-)
				- [リストで計算](#)
				- [条件判定とシンボル](#)
			- [関数定義で初心者脱出](#)
				- [defineで関数を定義](#define)
				- [defineでアトム同士をつなぐ](#define)
			- [条件分岐は多種多様](#)
			- [繰り返しと再起定義](#)
		- [2.プログラミングRacket ソフトウェア開発編](#2racket-)
<!-- /TOC -->

## 0.序文と下準備
### この文書について
この文書は、現在日本語の情報が少ないプログラミング言語Racketについて、プログラミング初心者の方でもわかりやすいように解説し、Racketのプログラミングがある程度できるようになるところまで持っていくことを目指しています。これからプログラミングを始める人のために経験者の方には少し表現がくどくなっているかもしれませんが、ご了承ください。

### はじめに-RacketとLisp
1950年代に、ジョン・マッカーシーにより、Lispというプログラミング言語が作られました。Lispは当時の主流であったプログラミング言語(FortranやCobolなど)とは構造がかけはなれていたため、あまり流行ることもなく、また当時のコンピュータの処理性能にたいしては重たい言語であったためさほど普及しませんでしたが、他の言語にはない様々な機能があったため、人工知能などの研究用として残りつづけました。
Lispはその後、2つの大きな方言(元のプログラミング言語にたいし基本構造はかわらないが、細かな違いや改良がみられるプログラミング言語)を産みました。Common LispとSchemeです。それぞれに目指しているものが違い、Common Lispは多機能で様々なプログラムができるように、Schemeは言語としてのシンプルさを追求していました。
Racketは、Schemeから派生したLisp方言の1つです。かつてはPLT Schemeと呼ばれていました。RacketはSchemeの機能を取りいれつつかなり多機能な言語となっており、Common LispとSchemeの中間的存在と言えるかもしれません。

#### Racketの特徴
* RacketはSchemeから派生したため、Schemeとよく似ています。そのため、Schemeを強化するために作られたライブラリ集srfiを組み込んで使うことができます。（現在Racketで使えるsrfiは、[Racketのsrfiのページ](http://docs.racket-lang.org/srfi/index.html)を参照してください。）
* RacketにはデフォルトでGUIの開発に必要な関数郡が揃っています。これにより、これまでのCommon LispやSchemeでは環境をそろえることすら難しかったGUIについて、手軽に触れることができるようになっています。

### Racketプログラミングのための準備
Racketは公式がプログラミング用のソフト(IDE)を配布しているので、とりあえずはこれを使うことをお勧めします。自分のお気に入りのエディタがあるひとは、それを使ってもいいとおもいますが、マイナーな言語ですので、エディタによっては、シンタックスハイライト(ソースコードの色分けや、文法ミスの検出などの機能のこと。ソースコードを見やすくするためのもので、なくても問題はありませんがあったほうが捗ります)がないこともあります。

#### インストール
* **Windows** <br>
[Racket公式サイト](http://racket-lang.org)にアクセスし、画面上部の「Download」をクリック。Distributionが「Racket」、PlatformがWindowsであることを確認して、ダウンロード。exe形式なので、そのままインストールしてください。一応ミラーサイトもあります。

  **Mac** <br
Windowsと同じようにRacketの公式サイトからダウンロードしてください。他の方法もあるかもしれませんが、筆者はMacを使ったことがないのでわかりません。公式サイトからで問題はないと思います。

* **Linux(Debian,Ubuntu系)** <br>
Windows、Macと同じようにRacketの公式サイトからダウンロードする方法と、aptリポジトリを使う方法があります。リポジトリは ppa:plt/racketです(公式リポジトリで、アップデートを自動でやってくれるためこちらのほうがおすすめです。)


* **Minimal RacketとRacketの違いについて**  
  Racketをダウンロードするときに、Minimal Racketというものが選択肢にあるとおもいます。これは、Racketとしての必要最低限の機能だけを搭載し、あとからパッケージという形でRacketに機能を追加できるようにしたパッケージです。この文書は、普通のRacketを導入することを前提で書いていますので、特に理由がなければRacketをダウンロードすることをおすすめします。

#### 起動および日本語化  
インストールすると、ソフト一覧に、DrRacketが追加されると思います。これがRacketのIDEです。この記事では、これを使ってプログラミングすることを想定して書かれています。他のエディタを使っている人は、適宜読みかえてください。 <br>
さて、DrRacketを起動すると、英語版として立ちあがるかもしれません。このままでも問題はありませんが、日本語がいいという方は、メニュータブの右端「Help」をクリックしてください。さまざまな言語でかかれたメニューの中に、「DrRacketを日本語で使う」というのがあると思います。クリックすると、DrRacketを再起動するか聞かれるので、承認して再起動させましょう。これを行なうことで、それ以降はDrRacketを日本語で使えるようになります。

では、次の章から、Racketによるプログラミングを始めていきましょう。

#### まとめ
* Lispの一方言、Racket
* ダウンロードは公式サイトから
* 開発環境もついてくるので手軽に始められます。

## 1.プログラミングRacket Racket基礎編
ここではRacketの基本的な文法について解説します。Racketの派生元であるSchemeの解説としても使えると思います。

### Racket基礎その1 Hello World!とリストに関する各種名称

#### まずはお決まり、Hello World!
DrRacketを起動させると、#lang racket と書かれたエディタ部分、その下の、シェルの部分が目につくと思います。これは、Lisp系の言語の開発環境にはかならずといっていいほど付属する対話環境とよばれるものです。他のプログラミング言語とはすこし違いますが、使っていくうちになれます。

それでは、Racketのプログラミングを始めていきましょう。まずは、色々な言語で最初にやる画面に「Hello World!」と表示するプログラムを作ってみましょう。以下のコードを書きこんでください。全ての文字は、半角を使用してください。(#lang racketの部分は、もとから書かれていますので、これ以降は基本省略します)

```racket
#lang racket

(display "Hello World!")

```
書き込んだら実行してみましょう。ソフト上部の「実行」と書かれた緑色の三角形のボタンを押してください。(保存しなくても実行できます。)
実行すると、画面下部の対話環境に、以下の様に表示されると思います。
エラーメッセージがでた人は、カッコが半角であるかや、全角空白が入っていないかどうかを確認してください。
```racket
Hello World!
>
```

では、このプログラムについてみていきましょう。
Racketの世界では、全てのプログラムおよびデータは()-丸カッコでくくられます。これをリストといいます。Racketの世界では、プログラムとプログラムで扱うデータを同じようにリストで表現します。このうち、プログラムとしてのリストは、先頭の要素および残りの要素に大別されます。このプログラムでいうと、「write」が先頭の部分にあたり、「"Hello World!"」が残りの部分にあたります。プログラムとしてのリストの先頭と残りには、それぞれ役割があります。先頭の要素がプログラムの名前であり、残りの要素が「引数(ひきすう)」と呼ばれる、そのプログラムの動作を決定するものです。
このプログラムの場合、「display」というのが画面に文字を入力せよという命令(関数といいます)であり、「"Hello World!"」がdisplayに対する引数となっています。
"Hello World"の""の中を自分の好きな文字列に変えて、実行してみてください。自分の入れた文字列が表示されたはずです。displayという命令が変わっていないので画面に文字列を出力するということは同じですが、引数が違うため微妙に動作が違うのです。


#### Racketの構造
先ほど、関数とデータが、同じリストという構造でできているという話がありました。今度は、Racketのデータについても見ていきましょう。
Racketでは、リストを次のように書きます。次のリストは、a、b、cの3つの要素をもつリストです。
```racket
(a b c)
```
リストは多層構造にもできます。次のリストは、1年の各月とその月の最終日を表わしたリストです。
```racket
((1 31)(2 28)(3 31)(4 30)(5 31)(6 30)(7 31)(8 31)(9 30)(10 31)(11 30)(12 31))
```

リストの先頭要素が関数であった場合に、その関数を実行することを評価といいます。さきほどの
```racket
(display "Hello World!")
```
のプログラムは、関数「display」に引数「"Hello World!"」を評価させていたということです。
では、このdisplayに、データとしてのリストを与えてみましょう。
```racket
(display (1 2))
```
これを実行すると、エラーがでます。
```racket
. . application: not a procedure;
 expected a procedure that can be applied to arguments
  given: 1
  arguments.:
>
```
このエラーは、リストを引数に与えたからでたわけではありません。引数として与えられたリストの先頭のアトムが、関数でなかったからおきたものです。  
プログラムを実行すると、Racketはリストの先頭の要素を見にいきます。displayはRacketで関数として登録されているので、その定義にしたがってリストの残りの要素を画面に出力しようとします。すると、残りの要素はリストということになりました。このときRacketは、そのリストを評価しにいきます。このプログラムでは、(1 2)の部分です。しかし先頭の要素が「1」で、関数ではないためRacketは評価ができず、エラーを返したのです。
では、このような場合にはどうすればいいでしょうか。次のプログラムを見てください。
```racket
(display '(1 2))
```
このプログラムを実行すると、エラーが出ずに、(1 2)と出力されます。実は、リストの前に'(クオート)を付けるとRacketはそのリストを単なるデータとみなし、評価をしないのです。
皆さんも様々なリストを入れてみてください。なお、Hello worldの時のように"(1 2)"としても出力することができますが、リストに対しては、'を使ったほうが便利なことが多いので、リストに対してはこちらを使っていきましょう。

#### まとめ
* Racketはリストとよばれる()を使った構造で、プログラムやデータを書く。
* リストは、多層構造にすることができる。
* Racketのプログラムを実行すると、リストの先頭の要素は
* リストを評価するとcar部を関数としcdr部を引数として実行する。
* リストを評価されたくない時は、前カッコの前に'(クオート)をつける。


### Racket基礎その2 リストの操作とアトムについて
#### 対話環境の使い方
さて、前回まではエディタ部分にプログラムを書いて実行してきました。しかし、(display '(1 2))などとかいて、一々実行するのも面倒です。ここで、すこし手間を省きましょう。これまでプログラムを実行すると、下の対話環境に出力されていましたが、そこに直接プログラムを書いてみましょう。次のプログラムを書いて、エンターキーを押してください。
```racket
>(display '(one two three))
'(one two three)
```
エディタ部分に書いて実行したときと同じように、displayが実行されました。このように対話環境は、テキストに書かれたプログラムの実行だけでなく、直接プログラムを実行することもできるのです。
今の所、対話環境だけで押し通してもRacketの習得上問題はないので、当分は手軽に対話環境にプログラムを直接打ち込む方式でいきましょう。(プログラムをテキストに書きこむ方式がいいという人は、別にかまいません。結果がかわるわけではありませんから)やがてテキストに書くプログラムが必要になったら、あらためてテキストに戻ることにしましょう。

#### リストの各要素は、アトム
もう少しプログラミング以前の話がつづきます。
前回までで、リスト(1 2 3)の1や2などを、要素と呼んできましたが、これからはRacketおよびLispの伝統にしたがって、アトムとよぶことにします。アトムとは英語で「元素」の意味であり、リストを構成しているものという感じがしますね。アトムが組みあわせたリストは、「分子」といったところでしょうか。
```racket
((a b) (c (d e)))
```
上のように多層構造のリストの場合、アトムは、a、b、c、d、eの5つのことです。全てのカッコをとったのこりと考えるとわかりやすいでしょう。

#### リスト操作のおきまり、carとcdr
では今回の本題です。今回は、リストの中から特定のアトムを抜きだす操作を覚えましょう。次のプログラムを実行してください。
```racket
(car '(a b c))
```

```lisp
(cdr '(a b c))
```

いかがでしたでしょうか。それぞれリストの先頭のアトム「a」および残りの部分「'(b c)」が出力されたと思います。クダー部のリストに'がついているのは、評価前のリストがすでに'で評価されないようにしていたからです。また、カー部であるaの方に'がついていないのは、数字に関しては評価しないという取り決めがあるからです。(先程のdisplayとは、出力時の文字の色が違うかもしれませんが、いまは気にしないでください)
これらの関数はRacketの先祖であるLispができたころから存在していたいにしえの関数です。Racketに限らずLisp系の言語はリストの操作にこの名前を使っている名前が多いです。
これまでリストを先頭の要素と残りの要素というふうに分けてきましたが、これらの関数名に従い、これからはそれぞれ先頭の要素をcar(カー)、残りの要素をcdr(クダー)と呼ぶことにします。
リストは、多層構造にすることもできるという話をしました。では、次のプログラムを見てください。

```racket
(car '((1 2)(3 4)))
```

```racket
(cdr '((dog)(cat (mouse rabbit))))
```
これを実行すると
```racket
>(car '((1 2)(3 4)))
'(1 2)
>(cdr '((dog)(cat (mouse rabbit))))
'(cat (mouse rabbit))
```
このようになりました。リストが多層構造になっている時に、carやcdrをとると、リストの中のリストは、
それでは練習問題です。以下のリストについてcarとcdrを推測してください。
```racket
(1 2 3 4 5)
((1 2)(3 4))
(((1))(1 2))
```
carとcdrを考える時のコツは、リストの一番外側の「(」前カッコを、右に一つずらすということです。
答えはこの章の最後にまとめてあります。各自でもcarやcdrで確認しましょう。

いかがでしたか。章末に答えをのせていますが、実際に打ちこんでしらべた方がはやいかもしれません。もし巻末の答えが実際の挙動と違っていた場合は、githubのissuesにお願いします。
ではもうひとつ、
```racket
(a)
```
これのcarとcdrをとってみましょう。carは予測がつくと思いますが、cdrはどうなるでしょう。
```racket
>(car '(a))
a
>(cdr '(a))
'()
```
中にアトムがない、ただのカッコがでてきました。これは空リストとよばれるもので、要素を1つも持たないリストです。要素が0個のリストともいえますね。では、このリストのcarとcdrを取るとどうなるでしょう。

```racket
>(car '())

>(cdr '())
```
どちらもエラーがでました。Racketでは空リストのcarやcdrをとってはいけないことになっています。これは後々条件分岐の所で重要になってきますので、気にとめておいてください。(他のLisp系言語をやったことのあるひとは、空リストのcdrがエラーになることや、nilが出ないことなどに違和感をいだくかもしれませんが、わりきってください)
Racketの定義では、carとcdrは、1つ以上のアトムを含むリストを引数にとることとなっています。

#### carとcdrの複合技
ここまで、carとcdrでリストを評価するとどこのアトムやリストがでてくるのかをみてきました。では、リストの2番目や3番目の要素が必要になったときは、どうすればいいでしょう。
ここで、cdrに注目してみましょう。
```racket
>(cdr '(1 2 3))
(2 3)
```
上のプログラムで、carをとったあとのリストを見てみると、これもリストであり、carやcdrをつかうことができる構造になっています。これで、リストの2番目のアトムを取りだすめどがたちました。
```racket
>(cdr '(1 2 3))
'(1 2)
>(car '(1 2))
1
```
このようになりました。今は一回づつやりましたが、これは組みあわせて使うことができます。
```racket
>(car (cdr '(1 2 3)))
1
```
このプログラムを実行すると、Racketは始めにリストの先頭要素をみて、carなので残りのリストを評価しようとします。しかし、評価すべきリストもcdrのプログラムなので、中のcdrを先に評価して評価した値をcarに渡すのです。
このようにして、リストの2番目や3番目をとりだすことができました。ところで、Racketにはリストの2番目や3番目を一発で返す関数も用意されています。cadrや、caddrなどです。
```racket
>(cadr '(chicken pork beef))
'pork
>(caddr '(tuna salmon swordfish))
'swordfish
```
carやcdrの組みあわせ技なので、命名規則もそれにのっとっています。c{}rの{}のあいだには、carを表すaか、cdrを表わすdかが、その関数を使う順番に**後ろから**はいっています。つまり、caddrならcdr→cdr→carと実行したのとおなじということです。一見後ろからいれるのは不思議に思えるかもしれませんが、先程の入れ子プログラムをみるとわかりやすいかと思います。
```racket
(car (cdr '(1 2 3)))
(cadr '(1 2 3))
```
この2つのプログラムは同じはたらきをします。cadrのaとdの並び方が入れ子にしたプログラムのcarとcdrの位置関係と同じことに気づかれたでしょうか。わからなくなったときは入れ子のプログラムを思いだすと理解しやすいとおもいます。
なおcarとcdrの複合関数は、いくらでも使えるというわけではなく、caddddrくらいまでとなっています。これ以降のアトムを取りだしたいときは、(cadddr (cddddr ...))という風にするのが得策でしょう。あえてリストの20番目を一発でとる関数などがほしい人も、ここから何章か進んだ関数定義の章や再帰定義の章などを学習することで自分で作ることができるようになります。

#### まとめ
* リストを構成する各要素のことをアトムという。
* リストの先頭のアトムはcar、先頭を除く残りのリストはcdrで取り出すことができる。
* carとcdrはリストを入れ子にすることで2番目以降のアトムを取りだすことができる。
* 入れ子にする以外にも、リストの5番目程度まではcadrやcaddrなどの関数が用意されている。
* それ以上の場合は、入れ子にするか後々関数定義や再帰定義などを学ぶことで自分で作ることができる。

#### 練習問題の解答

### Racket基礎その3 リストを作る
#### carとcdrの逆関数、cons
前回は、リストの中からアトムやリストを抜き出す操作をやってきました。今回は、リストを作りだす関数についてです。
```racket
>(cons 'a '(b c))
(a b c)
```
### Racket基礎その4 算術計算と条件演算子
#### リストで計算
前回までは、リスト操作の基本関数であるcarとcdr及びその派生関数について解説してきました。今回は少し趣向がかわりまして、計算を行なう関数と、条件演算子とよばれるものについてです。次回以降の自分で関数定義をしていく章において重要となってくるので、がんばってください。

まずは、リストを使って計算をしましょう。Racketには、displayやcarなどのように、数学的な計算を行う関数も用意されています。四則演算を行う関数のことを特別に、算術演算子といいます。
```racket
(+ 2 4)
(- 12 4)
(* 5 9)
(/ 35 7)
```
これらは上から順に、足し算、引き算、かけ算、割り算をあらわしています。かけ算で×を使わないのは、キーボードに×の記号を表す文字がなかったからです。これに関しては覚えてください。割り算が/なことに関しては、コンピューター上で分数をあらわす時の約束としてこれまでにも見たことがあるとおもいます。
算術演算子がこれまでのcarなどと違う点は、引数をいくらでもとれるところです。
```racket
>(+ 1 2 3 4 5 6 7 8 9 10)
55
>(* (+ 2 2) (- 5 4) 2 4)
32
```
これは計算が楽になりそうですね。元々Racketの始祖であるLispは、数学的な考え方から生まれました。このように算術演算子を一番前において、後ろに計算する数字を並べる書き方のことを前置記法といいます。一方、私達が普段使っている、「3 + 4」などの書き方は、中置記法といいます。前置記法のいいところは、複数の数字にたいして同じ演算をする(まとめて足し算やかけ算をする)時に、算術演算子を1つ書けばすむことです。この考えかたが後々、Racketにでてくる算術演算子以外の、沢山の引数をとる関数などのところで役立つことになります。

#### 条件判定とシンボル
算術演算子に続いて、条件演算子について見ていきましょう。この関数群はそれ単体では大した機能をもちませんが、状況によって動作を変えるプログラムを作る時にとても役に立つものです。
条件演算子は、あたえられた引数にたいし、「真」をあらわす#tか「偽」をあらわす#fを返します。
```racket
>(list? '(a b))
#t
>(atom? '(a b))
#f
>(atom? 'a)
#t
```
上にあげたのは、条件演算子をつかった例です。関数名からなんとなく機能がわかると思います。list?は、与えられた引数がリストかどうかを、atom?は引数がアトムかどうかを調べます。「'」をつけるのを忘れないでください。
さて、今あげた関数は、いずれも引数が~であるか?を調べる、1引数の関数でした。しかし、これだけでは、2つの物が同じかを比較することができません。勿論、Racketにはそういう関数も用意されています。
```racket
>(= 10 10)
#t
>(= 10 9)
#f
```
### 関数定義で初心者脱出
#### defineで関数を定義
いよいよ今回から、自分で関数を定義していきます。これによって、一応Racketのプログラムが書けるようになります。今回使う関数は、defineというものです。defineの構造はこれまでの関数と少しちがっていて、次のようになっています。
```racket
(define (関数名 引数...) (関数の内容))
```
これまでの関数と違うところは、まず、引数を評価しないことです。例として、与えられた数を二乗する関数を定義してみましょう。関数名はsquareとします。
```racket
(define (square x) (* x x))
```
もしdefineが、引数を評価してしまうと、squareという関数がないのでエラーがでてしまうのです。ではdefineはどのような動きをするのでしょうか。S式同士を接続するというのが、defineの動きの表現としていいかもしれません。上のsquareの式では、(square x) と、(* x x)が接続されるのです。この後、(square 5)などという式を実行すると

#### defineでアトム同士をつなぐ
### 条件分岐は多種多様

### 繰り返しと再起定義

## 2.プログラミングRacket ソフトウェア開発編
